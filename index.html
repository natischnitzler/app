<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Temponovo">
<link rel="manifest" href="/manifest.json">
<link rel="icon" type="image/png" href="/temponovo-logo-color.png">
<link rel="apple-touch-icon" href="/temponovo-logo-color.png">
<title>Temponovo - Cat√°logo Digital</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Roboto',sans-serif;background:#f5f5f5;color:#333}

.header{background:#2c3e50;padding:16px 20px;display:flex;align-items:center;justify-content:flex-end;position:relative}
.logo{height:35px}
.sync-status{display:flex;align-items:center;gap:8px}
.sync-dot{width:8px;height:8px;border-radius:50%;background:#4caf50}
.sync-label{font-size:11px;color:rgba(255,255,255,0.8)}
.last-update{position:absolute;top:16px;left:20px;font-size:10px;color:rgba(255,255,255,0.6)}

.screen{display:none}
.screen.active{display:block}

.home-content{padding:16px;padding-bottom:80px}
.update-now-btn,.download-btn{background:#2c3e50;color:white;border:none;padding:14px 16px;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:6px;transition:all 0.2s}
.update-now-btn:active,.download-btn:active{opacity:0.8}
.download-btn:disabled{background:#95a5a6;cursor:not-allowed;opacity:0.6}
.download-btn.has-selection{background:#27ae60}
.bottom-buttons{position:fixed;bottom:0;left:0;right:0;background:white;border-top:1px solid #e0e0e0;padding:12px 16px;display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;z-index:50}

.category-accordion{background:white;border-radius:12px;margin-bottom:12px;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,0.08)}
.category-header{background:#2c3e50;color:white;padding:14px 18px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;user-select:none}
.category-header:active{opacity:0.9}
.category-left{display:flex;align-items:center;gap:12px;flex:1}
.category-title{font-size:16px;font-weight:600}
.category-count{font-size:13px;background:rgba(255,255,255,0.25);padding:4px 12px;border-radius:12px;margin-right:8px}
.chevron-icon{font-size:20px;transition:transform 0.3s}
.category-accordion.open .chevron-icon{transform:rotate(90deg)}
.category-content{max-height:0;overflow:hidden;transition:max-height 0.3s ease}
.category-accordion.open .category-content{max-height:3000px}

.catalog-list{background:#fafafa}
.catalog-item{padding:12px 16px;border-bottom:1px solid #e8e8e8;display:flex;align-items:center;gap:12px}
.catalog-item:last-child{border-bottom:none}
.catalog-checkbox{width:20px;height:20px;cursor:pointer;accent-color:#2c3e50;flex-shrink:0}
.catalog-info{flex:1;cursor:pointer;min-width:0}
.catalog-name{font-size:15px;font-weight:500;color:#333;margin-bottom:3px}
.catalog-meta{font-size:12px;color:#999}

.pdf-header{background:white;border-bottom:1px solid #e0e0e0;padding:12px 20px;display:flex;align-items:center;gap:12px;position:sticky;top:0;z-index:100;box-shadow:0 1px 3px rgba(0,0,0,0.08)}
.back-btn{background:none;border:none;color:#2c3e50;font-size:28px;cursor:pointer;padding:0;line-height:1;font-family:Arial}
.pdf-title{flex:1;font-size:16px;font-weight:500;color:#333}
#sort-buttons{display:flex;gap:8px;margin-top:8px}
.sort-btn{background:#f0f0f0;color:#666;border:none;padding:6px 12px;border-radius:6px;font-size:12px;font-weight:500;cursor:pointer;transition:all 0.2s}
.sort-btn:hover{background:#e0e0e0}
.sort-btn.active{background:#2c3e50;color:white}
.filter-toggle-btn{background:#2c3e50;color:white;border:none;padding:8px 16px;border-radius:8px;font-size:13px;font-weight:500;cursor:pointer;display:flex;align-items:center;gap:6px;margin-right:8px}
.filter-toggle-btn:active{opacity:0.8}
.filter-count{background:#27ae60;color:white;padding:2px 8px;border-radius:10px;font-size:11px;font-weight:700}
.share-btn{background:#2c3e50;color:white;border:none;padding:8px 16px;border-radius:8px;font-size:13px;font-weight:500;cursor:pointer;display:flex;align-items:center;gap:6px}
.share-btn:active{opacity:0.8}

.filters-sidebar{position:fixed;top:0;right:-300px;width:280px;height:100vh;background:white;box-shadow:-2px 0 10px rgba(0,0,0,0.1);z-index:200;transition:right 0.3s;overflow-y:auto}
.filters-sidebar.open{right:0}
.filters-header{background:#2c3e50;color:white;padding:16px;display:flex;align-items:center;justify-content:space-between}
.filters-title{font-size:16px;font-weight:600}
.close-filters{background:none;border:none;color:white;font-size:24px;cursor:pointer;padding:0}
.filter-section{padding:16px;border-bottom:1px solid #e8e8e8}
.filter-section-title{font-size:14px;font-weight:600;color:#333;margin-bottom:12px}
.filter-option{display:flex;align-items:center;gap:10px;margin-bottom:10px}
.filter-option input{width:18px;height:18px;cursor:pointer;accent-color:#2c3e50}
.filter-option label{font-size:13px;color:#666;cursor:pointer;flex:1}
.filter-option-count{font-size:11px;color:#999}
.clear-filters-btn{background:#e74c3c;color:white;border:none;padding:12px;width:calc(100% - 32px);margin:16px;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer}
.clear-filters-btn:active{opacity:0.8}
.filters-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:199;display:none}
.filters-overlay.show{display:block}

.pdf-page{background:white;max-width:100%;margin:0;padding-top:0}
.pdf-page-title{font-size:20px;font-weight:700}
.pdf-page-date{font-size:12px;opacity:0.9;margin-top:4px}
.pdf-products{padding:20px;display:grid;grid-template-columns:repeat(4,1fr);gap:20px}
.pdf-product{background:white;border:1px solid #e0e0e0;border-radius:8px;overflow:hidden;transition:all 0.2s}
.pdf-product:hover{box-shadow:0 4px 16px rgba(0,0,0,0.1)}
.pdf-product-img-wrap{width:100%;aspect-ratio:1;background:#fafafa;display:flex;align-items:center;justify-content:center;border-bottom:1px solid #e8e8e8;padding:24px;position:relative}
.pdf-product-img-wrap img{width:100%;height:100%;object-fit:contain}
.pdf-product-img-wrap .emoji{font-size:72px}
.stock-corner{position:absolute;top:12px;right:12px;min-width:38px;height:38px;padding:0 10px;border-radius:19px;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;color:white;box-shadow:0 3px 10px rgba(0,0,0,0.3)}
.stock-corner.high{background:#4caf50}
.stock-corner.medium{background:#ff9800}
.stock-corner.low{background:#f44336}
.pdf-product-info{padding:12px 16px;text-align:center}
.pdf-product-code{font-size:22px;font-weight:700;color:#000;margin-bottom:8px;letter-spacing:0.3px}
.pdf-product-category{font-size:12px;color:#666;margin-bottom:6px;font-weight:500}
.pdf-product-price{font-size:22px;color:#2c3e50;font-weight:700;margin-bottom:8px}
.pdf-product-price span{font-size:13px;font-weight:400;color:#999}
.product-features{font-size:16px !important;color:#333 !important;line-height:1.4;margin-top:4px;padding-top:0;border-top:none;text-align:center;font-weight:400 !important}
.pdf-footer{background:#f8f8f8;padding:16px 20px;border-top:1px solid #e0e0e0;text-align:center;font-size:11px;color:#666;line-height:1.6}

@media (max-width:480px){
  .pdf-products{grid-template-columns:repeat(4,1fr);gap:8px;padding:10px}
  .pdf-product-img-wrap{padding:8px}
  .pdf-product-img-wrap .emoji{font-size:32px}
  .pdf-product-info{padding:6px}
  .pdf-product-code{font-size:15px;margin-bottom:3px}
  .pdf-product-category{font-size:9px;margin-bottom:3px}
  .pdf-product-price{font-size:11px;margin-bottom:3px}
  .product-features{font-size:12px !important;font-weight:400 !important}
  .stock-corner{top:4px;right:4px;min-width:22px;height:22px;font-size:9px}
  .contact-info{flex-direction:column;align-items:flex-start;gap:6px}
  .header-stats{gap:28px}
  .stat-number{font-size:24px}
}

@media (min-width:481px) and (max-width:1024px){
  .pdf-products{grid-template-columns:repeat(4,1fr);gap:16px;padding:16px}
  .pdf-product-img-wrap{padding:18px}
  .pdf-product-img-wrap .emoji{font-size:60px}
  .pdf-product-info{padding:14px}
  .pdf-product-code{font-size:15px}
  .pdf-product-price{font-size:19px}
  .pdf-product-category{font-size:12px}
}

.loading-state{text-align:center;padding:60px 20px;color:#999}
.spinner{width:40px;height:40px;border:3px solid #f0f0f0;border-top-color:#2c3e50;border-radius:50%;animation:spin 0.8s linear infinite;margin:0 auto 16px}
@keyframes spin{to{transform:rotate(360deg)}}

.toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#323232;color:white;padding:12px 24px;border-radius:8px;font-size:14px;opacity:0;pointer-events:none;transition:opacity 0.3s;z-index:9999}
.toast.show{opacity:1}

.admin-btn{position:fixed;bottom:20px;right:20px;width:56px;height:56px;background:#2c3e50;color:white;border-radius:50%;border:none;font-size:24px;cursor:pointer;box-shadow:0 4px 12px rgba(44,62,80,0.4);z-index:50}
.admin-btn:active{transform:scale(0.95)}
</style>
</head>
<body>

<div id="home" class="screen active">
  <div class="header">
    <div class="last-update" id="last-update-display">√öltima actualizaci√≥n: --</div>
    <div class="sync-status">
      <img src="https://www.temponovo.cl/asset/img/temponovo-logo-color.svg" alt="Temponovo" class="logo">
      <div class="sync-dot"></div>
      <span class="sync-label" id="sync-label">Cargando...</span>
    </div>
  </div>
  
  <div class="home-content">
    <div id="home-content-inner">
      <div class="loading-state">
        <div class="spinner"></div>
        <div>Sincronizando...</div>
      </div>
    </div>
  </div>
  
  <div class="bottom-buttons">
    <button class="download-btn" onclick="forceUpdate()">
      <span>üîÑ</span>
      <span>Actualizar</span>
    </button>
    <button class="download-btn" onclick="downloadSelectedCatalogs()" id="download-selected-btn" disabled>
      <span>üìÑ</span>
      <span id="selected-count-text">Seleccionar</span>
    </button>
    <button class="download-btn" onclick="downloadAllCatalogs()">
      <span>üì¶</span>
      <span>Todos</span>
    </button>
  </div>
  
  <button class="admin-btn" onclick="showAdminPanel()">‚öôÔ∏è</button>
</div>

<div id="pdf-viewer" class="screen">
  <div class="pdf-header">
    <button class="back-btn" onclick="goHome()">‚Äπ</button>
    <button class="back-btn" onclick="navigateCatalog(-1)" id="prev-catalog-btn" style="margin-left:8px">‚Äπ‚Äπ</button>
    <div class="pdf-title">
      <div id="pdf-title-header"></div>
      <div style="font-size:11px;color:#999;margin-top:2px" id="product-count-label"></div>
      <div id="sort-buttons" style="display:none;margin-top:8px;gap:8px">
        <button class="sort-btn active" onclick="sortProducts('subfamily')" id="sort-subfamily">Por Subfamilia</button>
        <button class="sort-btn" onclick="sortProducts('alpha')" id="sort-alpha">Alfab√©tico</button>
        <button class="sort-btn" onclick="sortProducts('family')" id="sort-family">Por Familia</button>
      </div>
    </div>
    <button class="back-btn" onclick="navigateCatalog(1)" id="next-catalog-btn" style="margin-right:8px">‚Ä∫‚Ä∫</button>
    <button class="filter-toggle-btn" onclick="toggleSearch()" id="search-btn" style="display:none;margin-right:8px">
      <span>üîç</span>
    </button>
    <button class="filter-toggle-btn" onclick="toggleFilters()" id="filter-btn">
      <span>‚öô</span>
      <span>Filtros</span>
      <span class="filter-count" id="filter-count" style="display:none">0</span>
    </button>
    <button class="share-btn" onclick="shareCatalogPDF()">
      <span>üìÑ</span>
      <span>PDF</span>
    </button>
  </div>
  
  <div id="search-bar" style="display:none;padding:12px 20px;background:#f8f8f8;border-bottom:1px solid #e0e0e0">
    <input type="text" id="search-input" placeholder="Buscar productos..." 
           oninput="searchProducts(this.value)"
           style="width:100%;padding:10px 16px;border:1px solid #ddd;border-radius:8px;font-size:14px;outline:none">
  </div>
  
  <div id="pdf-content" class="pdf-page"></div>
</div>

<div class="filters-overlay" id="filters-overlay" onclick="toggleFilters()"></div>
<div class="filters-sidebar" id="filters-sidebar">
  <div class="filters-header">
    <div class="filters-title">Filtros</div>
    <button class="close-filters" onclick="toggleFilters()">√ó</button>
  </div>
  <div id="filters-content"></div>
  <button class="clear-filters-btn" onclick="clearAllFilters()">Limpiar filtros</button>
</div>

<div class="toast" id="toast"></div>

<script>
const API_URL='https://temponovo-api.onrender.com/api/stock';
const CARACT_URL='https://temponovo-api.onrender.com/api/caracteristicas';
const UPDATE_INTERVAL=3*60*60*1000; // 3 horas
const DB_NAME='temponovo_catalogs';

let allProducts=[];
let catalogs={};
let catalogsByCategory={};
let currentCatalog=null;
let currentCatalogIndex=0;
let catalogList=[];
let selectedCatalogs=new Set();
let caracteristicas={};
let activeFilters={familias:[],subfamilias:[],generos:[],colores:[],tamanos:[],resistencias:[]};
let filteredProducts=[];
let selectedProducts=new Set();

function toggleCatalogSelection(n,e){
  e.stopPropagation();
  selectedCatalogs.has(n)?selectedCatalogs.delete(n):selectedCatalogs.add(n);
  updateSelectionUI();
}

function updateSelectionUI(){
  const c=selectedCatalogs.size;
  const btn=document.getElementById('download-selected-btn');
  const txt=document.getElementById('selected-count-text');
  if(c===0){
    btn.disabled=true;
    btn.classList.remove('has-selection');
    txt.textContent='Seleccionar';
  }else{
    btn.disabled=false;
    btn.classList.add('has-selection');
    txt.textContent=`Descargar (${c})`;
  }
}

function openDB(){
  return new Promise((res,rej)=>{
    const req=indexedDB.open(DB_NAME,1);
    req.onupgradeneeded=e=>{
      const db=e.target.result;
      if(!db.objectStoreNames.contains('products'))db.createObjectStore('products',{keyPath:'Default_code'});
      if(!db.objectStoreNames.contains('meta'))db.createObjectStore('meta',{keyPath:'key'});
    };
    req.onsuccess=()=>res(req.result);
    req.onerror=()=>rej(req.error);
  });
}

async function saveProducts(p){
  const db=await openDB();
  const tx=db.transaction(['products','meta'],'readwrite');
  const store=tx.objectStore('products');
  await store.clear();
  p.forEach(i=>store.put(i));
  const meta=tx.objectStore('meta');
  await meta.put({key:'last_sync',value:Date.now()});
  await meta.put({key:'product_count',value:p.length});
  return new Promise((res,rej)=>{
    tx.oncomplete=res;
    tx.onerror=()=>rej(tx.error);
  });
}

async function loadProducts(){
  const db=await openDB();
  const tx=db.transaction('products','readonly');
  const req=tx.objectStore('products').getAll();
  return new Promise((res,rej)=>{
    req.onsuccess=()=>res(req.result);
    req.onerror=()=>rej(req.error);
  });
}

async function getLastSync(){
  const db=await openDB();
  const tx=db.transaction('meta','readonly');
  const req=tx.objectStore('meta').get('last_sync');
  return new Promise(res=>{
    req.onsuccess=()=>res(req.result?.value||0);
    req.onerror=()=>res(0);
  });
}

function updateLastSyncDisplay(ts){
  const el=document.getElementById('last-update-display');
  if(!ts){el.textContent='√öltima actualizaci√≥n: --';return;}
  const d=new Date(ts);
  const now=new Date();
  const diff=now-d;
  const hours=Math.floor(diff/3600000);
  const days=Math.floor(hours/24);
  let txt;
  if(days>0)txt=`Hace ${days} d√≠a${days>1?'s':''}`;
  else if(hours>0)txt=`Hace ${hours} hora${hours>1?'s':''}`;
  else txt='Reci√©n actualizado';
  el.textContent=`√öltima actualizaci√≥n: ${txt}`;
}

async function fetchProducts(){
  setSyncStatus('Sincronizando...');
  try{
    const res=await fetch(API_URL);
    if(!res.ok)throw new Error(`HTTP ${res.status}`);
    const data=await res.json();
    if(!Array.isArray(data))throw new Error('Invalid response');
    const inStock=data.filter(p=>(p.Stock||0)>0);
    await saveProducts(inStock);
    allProducts=inStock;
    setSyncStatus('Actualizado');
    showToast(`‚úì ${inStock.length} productos sincronizados`);
    updateLastSyncDisplay(Date.now());
    return true;
  }catch(err){
    console.error('Sync error:',err);
    setSyncStatus('Offline');
    return false;
  }
}

async function forceUpdate(){
  if(!navigator.onLine){
    showToast('Sin conexi√≥n a internet');
    return;
  }
  showToast('Actualizando...');
  await fetchCaracteristicas();
  const success=await fetchProducts();
  if(success){
    buildCatalogs();
    showToast('‚úì Todo actualizado');
  }else{
    showToast('Error al actualizar');
  }
}

async function fetchCaracteristicas(){
  try{
    const res=await fetch(CARACT_URL);
    if(!res.ok)throw new Error(`HTTP ${res.status}`);
    caracteristicas=await res.json();
    console.log(`Caracter√≠sticas cargadas: ${Object.keys(caracteristicas).length}`);
  }catch(err){
    console.error('Error cargando caracter√≠sticas:',err);
  }
}

function setSyncStatus(l){
  document.getElementById('sync-label').textContent=l;
}

function buildCatalogs(){
  catalogs={};
  catalogsByCategory={};
  
  // Agrupar por Category (cat√°logos individuales)
  allProducts.forEach(p=>{
    // Si no tiene Category (subcategor√≠a), usar Parent_category directamente
    const category=p.Category || p.Parent_category || 'Sin categor√≠a';
    if(!catalogs[category]){
      catalogs[category]={
        name:category,
        products:[],
        parent:p.Parent_category||'Otros'
      };
    }
    catalogs[category].products.push(p);
  });
  
  // Agrupar cat√°logos por Parent_category (acordeones)
  for(const cat of Object.values(catalogs)){
    const parent=cat.parent;
    if(!catalogsByCategory[parent])catalogsByCategory[parent]=[];
    catalogsByCategory[parent].push(cat);
  }
  
  catalogList=Object.keys(catalogs).sort();
  renderCatalogList();
}

function toggleCategory(safeName){
  const el=document.getElementById(`cat-${safeName}`);
  if(el)el.classList.toggle('open');
}

function renderCatalogList(){
  const content=document.getElementById('home-content-inner');
  if(Object.keys(catalogsByCategory).length===0){
    content.innerHTML='<div class="loading-state"><div>Sin cat√°logos</div></div>';
    return;
  }
  
  let html='';
  
  // Categor√≠a TODOS - igual que el resto
  html+=`<div class="catalog-item" onclick="openAllProductsCatalog()" style="cursor:pointer">
    <div class="catalog-info">
      <div class="catalog-name">üì¶ TODOS</div>
      <div class="catalog-meta">${allProducts.length} productos</div>
    </div>
  </div>`;
  
  // Familias (Parent_category) - Click directo abre todos los productos
  for(const[parentName,cats]of Object.entries(catalogsByCategory)){
    const allProductsInFamily=cats.flatMap(c=>c.products);
    const safeName=parentName.replace(/'/g,"\\'");
    const isSelected=selectedCatalogs.has(parentName);
    html+=`<div class="catalog-item" style="display:flex;align-items:center;gap:12px">
      <input type="checkbox" class="catalog-checkbox" ${isSelected?'checked':''} 
             onchange="toggleCatalogSelection('${safeName}',event)">
      <div class="catalog-info" onclick="openFamilyCatalog('${safeName}')" style="cursor:pointer;flex:1">
        <div class="catalog-name">${parentName}</div>
        <div class="catalog-meta">${allProductsInFamily.length} productos</div>
      </div>
    </div>`;
  }
  
  content.innerHTML=html;
}

function openAllProductsCatalog(){
  currentCatalog={name:'Todos los productos',products:allProducts,isFamily:true};
  currentCatalogIndex=-1; // -1 = TODOS
  currentMode='catalogs';
  activeFilters={familias:[],subfamilias:[],generos:[],colores:[],tamanos:[],resistencias:[]};
  selectedProducts.clear();
  filteredProducts=allProducts;
  document.getElementById('pdf-title-header').textContent='Todos los productos';
  document.getElementById('sort-buttons').style.display='flex';
  document.getElementById('search-btn').style.display='flex';
  updateProductCount();
  renderFilters();
  updateFilterCount();
  sortProducts('alpha');
}

function openFamilyCatalog(familyName){
  const cats=catalogsByCategory[familyName]||[];
  const familyProducts=cats.flatMap(c=>c.products);
  const familyList=Object.keys(catalogsByCategory);
  currentCatalog={name:familyName,products:familyProducts,isFamily:true};
  currentCatalogIndex=familyList.indexOf(familyName); // √≠ndice en la lista de familias
  currentMode='catalogs';
  activeFilters={familias:[],subfamilias:[],generos:[],colores:[],tamanos:[],resistencias:[]};
  selectedProducts.clear();
  filteredProducts=familyProducts;
  document.getElementById('pdf-title-header').textContent=familyName;
  document.getElementById('sort-buttons').style.display='flex';
  document.getElementById('search-btn').style.display='flex';
  updateProductCount();
  renderFilters();
  updateFilterCount();
  sortProducts('alpha');
}

let currentSort='subfamily'; // Por defecto ordenar por subfamilia y luego alfab√©tico
function sortProducts(mode){
  currentSort=mode;
  document.querySelectorAll('.sort-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById(`sort-${mode}`).classList.add('active');
  
  let sorted=[...filteredProducts];
  if(mode==='alpha'){
    sorted.sort((a,b)=>{
      const codeA = cleanProductCode(a.Default_code, a.Name)||'';
      const codeB = cleanProductCode(b.Default_code, b.Name)||'';
      return codeA.localeCompare(codeB);
    });
  }else if(mode==='family'){
    // Ordenar por familia (primera parte de Category o Parent_category) y luego por c√≥digo
    sorted.sort((a,b)=>{
      // Extraer familia: "Relojes Casio / Murales" ‚Üí "Relojes Casio"
      const getFamilyPart = (cat) => {
        if(!cat) return '';
        return cat.split('/')[0].trim();
      };
      
      const famA = getFamilyPart(a.Category) || a.Parent_category || '';
      const famB = getFamilyPart(b.Category) || b.Parent_category || '';
      
      // Si misma familia, ordenar por c√≥digo
      if(famA===famB){
        const codeA = cleanProductCode(a.Default_code, a.Name)||'';
        const codeB = cleanProductCode(b.Default_code, b.Name)||'';
        return codeA.localeCompare(codeB);
      }
      
      return famA.localeCompare(famB);
    });
  }else if(mode==='subfamily'){
    sorted.sort((a,b)=>{
      const catA=a.Category||'';
      const catB=b.Category||'';
      
      // Si misma categor√≠a, ordenar por c√≥digo (no por nombre)
      if(catA===catB){
        const codeA = cleanProductCode(a.Default_code, a.Name)||'';
        const codeB = cleanProductCode(b.Default_code, b.Name)||'';
        return codeA.localeCompare(codeB);
      }
      
      return catA.localeCompare(catB);
    });
  }
  renderCatalogProducts(sorted);
  showScreen('pdf-viewer');
}

function toggleSearch(){
  const bar=document.getElementById('search-bar');
  const input=document.getElementById('search-input');
  if(bar.style.display==='none'){
    bar.style.display='block';
    input.focus();
  }else{
    bar.style.display='none';
    input.value='';
    searchProducts('');
  }
}

function searchProducts(query){
  if(!currentCatalog)return;
  const search=query.toLowerCase().trim();
  if(!search){
    sortProducts(currentSort);
    return;
  }
  const results=filteredProducts.filter(p=>{
    const name=(p.Name||'').toLowerCase();
    const code=(p.Default_code||'').toLowerCase();
    const category=(p.Category||'').toLowerCase();
    return name.includes(search)||code.includes(search)||category.includes(search);
  });
  renderCatalogProducts(results);
}

function getAvailableFilters(products){
  const filters={familias:{},subfamilias:{},generos:{},colores:{},tamanos:{},resistencias:{}};
  products.forEach(p=>{
    // Familia y Subfamilia
    const familia=p.Parent_category||'Otros';
    const subfamilia=p.Category||'';
    filters.familias[familia]=(filters.familias[familia]||0)+1;
    if(subfamilia)filters.subfamilias[subfamilia]=(filters.subfamilias[subfamilia]||0)+1;
    
    // Caracter√≠sticas
    const c=caracteristicas[p.Default_code];
    if(!c)return;
    if(c.genero)filters.generos[c.genero]=(filters.generos[c.genero]||0)+1;
    if(c.color)filters.colores[c.color]=(filters.colores[c.color]||0)+1;
    if(c.tamano_esfera)filters.tamanos[c.tamano_esfera]=(filters.tamanos[c.tamano_esfera]||0)+1;
    if(c.resistencia_agua)filters.resistencias[c.resistencia_agua]=(filters.resistencias[c.resistencia_agua]||0)+1;
  });
  return filters;
}

function renderFilters(){
  if(!currentCatalog)return;
  const filters=getAvailableFilters(currentCatalog.products);
  const content=document.getElementById('filters-content');
  let html='';
  
  // Familia
  if(Object.keys(filters.familias).length>0){
    html+=`<div class="filter-section"><div class="filter-section-title">Familia</div>`;
    Object.entries(filters.familias).sort((a,b)=>a[0].localeCompare(b[0])).forEach(([f,count])=>{
      const checked=activeFilters.familias.includes(f)?'checked':'';
      html+=`<div class="filter-option">
        <input type="checkbox" id="fam-${f}" ${checked} onchange="toggleMultiFilter('familias','${f}')">
        <label for="fam-${f}">${f}</label>
        <span class="filter-option-count">(${count})</span>
      </div>`;
    });
    html+=`</div>`;
  }
  
  // Subfamilia
  if(Object.keys(filters.subfamilias).length>0){
    html+=`<div class="filter-section"><div class="filter-section-title">Subfamilia</div>`;
    Object.entries(filters.subfamilias).sort((a,b)=>a[0].localeCompare(b[0])).forEach(([sf,count])=>{
      const checked=activeFilters.subfamilias.includes(sf)?'checked':'';
      html+=`<div class="filter-option">
        <input type="checkbox" id="sub-${sf}" ${checked} onchange="toggleMultiFilter('subfamilias','${sf}')">
        <label for="sub-${sf}">${sf}</label>
        <span class="filter-option-count">(${count})</span>
      </div>`;
    });
    html+=`</div>`;
  }
  
  if(Object.keys(filters.generos).length>0){
    html+=`<div class="filter-section"><div class="filter-section-title">G√©nero</div>`;
    Object.entries(filters.generos).sort((a,b)=>a[0].localeCompare(b[0])).forEach(([g,count])=>{
      const checked=activeFilters.generos.includes(g)?'checked':'';
      html+=`<div class="filter-option">
        <input type="checkbox" id="gen-${g}" ${checked} onchange="toggleMultiFilter('generos','${g}')">
        <label for="gen-${g}">${g}</label>
        <span class="filter-option-count">(${count})</span>
      </div>`;
    });
    html+=`</div>`;
  }
  
  if(Object.keys(filters.colores).length>0){
    html+=`<div class="filter-section"><div class="filter-section-title">Color</div>`;
    Object.entries(filters.colores).sort((a,b)=>a[0].localeCompare(b[0])).forEach(([c,count])=>{
      const checked=activeFilters.colores.includes(c)?'checked':'';
      html+=`<div class="filter-option">
        <input type="checkbox" id="col-${c}" ${checked} onchange="toggleMultiFilter('colores','${c}')">
        <label for="col-${c}">${c}</label>
        <span class="filter-option-count">(${count})</span>
      </div>`;
    });
    html+=`</div>`;
  }
  
  if(Object.keys(filters.tamanos).length>0){
    html+=`<div class="filter-section"><div class="filter-section-title">Tama√±o esfera</div>`;
    Object.entries(filters.tamanos).sort((a,b)=>a[0]-b[0]).forEach(([t,count])=>{
      const checked=activeFilters.tamanos.includes(parseInt(t))?'checked':'';
      html+=`<div class="filter-option">
        <input type="checkbox" id="tam-${t}" ${checked} onchange="toggleMultiFilter('tamanos',${t})">
        <label for="tam-${t}">${t}mm</label>
        <span class="filter-option-count">(${count})</span>
      </div>`;
    });
    html+=`</div>`;
  }
  
  if(Object.keys(filters.resistencias).length>0){
    html+=`<div class="filter-section"><div class="filter-section-title">Resistencia al agua</div>`;
    Object.entries(filters.resistencias).sort((a,b)=>a[0].localeCompare(b[0])).forEach(([r,count])=>{
      const checked=activeFilters.resistencias.includes(r)?'checked':'';
      html+=`<div class="filter-option">
        <input type="checkbox" id="res-${r}" ${checked} onchange="toggleMultiFilter('resistencias','${r}')">
        <label for="res-${r}">${r}</label>
        <span class="filter-option-count">(${count})</span>
      </div>`;
    });
    html+=`</div>`;
  }
  
  content.innerHTML=html;
}

function toggleFilters(){
  const sidebar=document.getElementById('filters-sidebar');
  const overlay=document.getElementById('filters-overlay');
  sidebar.classList.toggle('open');
  overlay.classList.toggle('show');
}

function toggleMultiFilter(type,value){
  const idx=activeFilters[type].indexOf(value);
  if(idx>-1){
    activeFilters[type].splice(idx,1);
  }else{
    activeFilters[type].push(value);
  }
  applyFilters();
  updateFilterCount();
}

function clearAllFilters(){
  activeFilters={familias:[],subfamilias:[],generos:[],colores:[],tamanos:[],resistencias:[]};
  applyFilters();
  renderFilters();
  updateFilterCount();
}

function updateFilterCount(){
  const total=activeFilters.familias.length+activeFilters.subfamilias.length+activeFilters.generos.length+activeFilters.colores.length+activeFilters.tamanos.length+activeFilters.resistencias.length;
  const badge=document.getElementById('filter-count');
  if(total>0){
    badge.textContent=total;
    badge.style.display='inline-block';
  }else{
    badge.style.display='none';
  }
}

function navigateCatalog(direction){
  const familyList=Object.keys(catalogsByCategory);
  const newIndex=currentCatalogIndex+direction;
  
  // Si estamos en TODOS (-1) y vamos atr√°s, no hacer nada
  if(currentCatalogIndex===-1&&direction<0)return;
  
  // Si estamos en TODOS y vamos adelante, ir a primera familia
  if(currentCatalogIndex===-1&&direction>0){
    if(familyList.length>0){
      openFamilyCatalog(familyList[0]);
    }
    return;
  }
  
  // Si vamos atr√°s desde primera familia, ir a TODOS
  if(newIndex<0){
    openAllProductsCatalog();
    return;
  }
  
  // Si llegamos al final, no hacer nada
  if(newIndex>=familyList.length)return;
  
  // Navegar a la familia
  openFamilyCatalog(familyList[newIndex]);
}

function updateProductCount(){
  const total=currentCatalog.products.length;
  const showing=filteredProducts.length;
  const label=document.getElementById('product-count-label');
  if(showing<total){
    label.textContent=`Mostrando ${showing} de ${total} productos`;
  }else{
    label.textContent=`${total} productos`;
  }
}
function applyFilters(){
  if(!currentCatalog)return;
  let filtered=currentCatalog.products;
  
  // Filtrar por Familia
  if(activeFilters.familias.length>0){
    filtered=filtered.filter(p=>{
      const familia=p.Parent_category||'Otros';
      return activeFilters.familias.includes(familia);
    });
  }
  
  // Filtrar por Subfamilia
  if(activeFilters.subfamilias.length>0){
    filtered=filtered.filter(p=>{
      const subfamilia=p.Category||'';
      return activeFilters.subfamilias.includes(subfamilia);
    });
  }
  
  if(activeFilters.generos.length>0){
    filtered=filtered.filter(p=>{
      const c=caracteristicas[p.Default_code];
      return c&&activeFilters.generos.includes(c.genero);
    });
  }
  if(activeFilters.colores.length>0){
    filtered=filtered.filter(p=>{
      const c=caracteristicas[p.Default_code];
      return c&&activeFilters.colores.includes(c.color);
    });
  }
  if(activeFilters.tamanos.length>0){
    filtered=filtered.filter(p=>{
      const c=caracteristicas[p.Default_code];
      return c&&activeFilters.tamanos.includes(c.tamano_esfera);
    });
  }
  if(activeFilters.resistencias.length>0){
    filtered=filtered.filter(p=>{
      const c=caracteristicas[p.Default_code];
      return c&&activeFilters.resistencias.includes(c.resistencia_agua);
    });
  }
  
  filteredProducts=filtered;
  updateProductCount();
  sortProducts(currentSort);
}

function openCatalog(n){
  const name=decodeURIComponent(n);
  currentCatalog=catalogs[name];
  if(!currentCatalog){
    showToast('Cat√°logo no encontrado');
    return;
  }
  currentCatalogIndex=catalogList.indexOf(name);
  currentMode='catalogs';
  activeFilters={familias:[],subfamilias:[],generos:[],colores:[],tamanos:[],resistencias:[]};
  selectedProducts.clear();
  filteredProducts=currentCatalog.products;
  document.getElementById('pdf-title-header').textContent=currentCatalog.name;
  document.getElementById('sort-buttons').style.display='none';
  document.getElementById('search-btn').style.display='none';
  document.getElementById('search-bar').style.display='none';
  updateProductCount();
  renderFilters();
  updateFilterCount();
  renderCatalogProducts(currentCatalog.products);
  showScreen('pdf-viewer');
}

function renderCatalogProducts(products){
  const today=new Date().toLocaleDateString('es-CL',{day:'2-digit',month:'2-digit',year:'numeric'});
  const photoBase=localStorage.getItem('photo_base_url')||'';
  let html='';
  
  if(selectedProducts.size>0){
    html+=`<div style="background:#27ae60;color:white;padding:12px 20px;display:flex;align-items:center;justify-content:space-between">
      <span>${selectedProducts.size} producto${selectedProducts.size>1?'s':''} seleccionado${selectedProducts.size>1?'s':''}</span>
      <button onclick="generateSelectedPDF()" style="background:white;color:#27ae60;border:none;padding:8px 16px;border-radius:6px;font-weight:600;cursor:pointer">Generar PDF</button>
    </div>`;
  }
  
  html+=`<div class="pdf-products">`;
  products.forEach(p=>{
    const price=formatPrice(p.Price||0);
    const stock=p.Stock||0;
    const stockDisplay=stock>100?'100+':stock;
    let stockClass='high';
    if(stock<10)stockClass='low';
    else if(stock<15)stockClass='medium';
    const imgTag=p.Default_code?`<img data-code="${p.Default_code}" class="lazy-img" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'/%3E" onerror="this.style.display='none';this.nextElementSibling.style.display='flex'" alt="${p.Name}" loading="lazy">`:'';
    const caract=caracteristicas[p.Default_code];
    let featuresHtml='';
    if(caract){
      const features=[];
      if(caract.genero)features.push(caract.genero);
      if(caract.color)features.push(caract.color);
      if(caract.tamano_esfera)features.push(`${caract.tamano_esfera}mm`);
      if(caract.resistencia_agua)features.push(caract.resistencia_agua);
      if(features.length>0){
        featuresHtml=`<div class="product-features">${features.join(' ‚Ä¢ ')}</div>`;
      }
    }
    const isSelected=selectedProducts.has(p.Default_code);
    html+=`
      <div class="pdf-product" style="position:relative">
        <input type="checkbox" ${isSelected?'checked':''} onchange="toggleProductSelection('${p.Default_code}')" 
               style="position:absolute;top:10px;left:10px;width:20px;height:20px;cursor:pointer;z-index:10;accent-color:#27ae60">
        <div class="pdf-product-img-wrap">
          ${imgTag}
          <div class="emoji" style="${imgTag?'display:none':'display:flex'}">üì¶</div>
          <div class="stock-corner ${stockClass}">${stockDisplay}</div>
        </div>
        <div class="pdf-product-info">
          <div class="pdf-product-code">${cleanProductCode(p.Default_code, p.Name)||''}</div>
          <div class="pdf-product-price">${price} <span>+ IVA</span></div>
          ${featuresHtml}
        </div>
      </div>`;
  });
  html+=`</div>
    <div class="pdf-footer">
      üìû 9 6292 9654 ¬∑ 2 2229 3138 | ‚úâÔ∏è ventas@temponovo.cl | üìç Las Carmelitas 51, Las Condes<br>
      Actualizado: ${today}
    </div>`;
  document.getElementById('pdf-content').innerHTML=html;
  
  // Cargar im√°genes bajo demanda
  setTimeout(()=>loadLazyImages(),100);
}

function toggleProductSelection(sku){
  if(selectedProducts.has(sku)){
    selectedProducts.delete(sku);
  }else{
    selectedProducts.add(sku);
  }
  renderCatalogProducts(filteredProducts);
}

// Cargar im√°genes bajo demanda CON L√çMITE DE CONCURRENCIA
async function loadLazyImages(){
  const lazyImages=Array.from(document.querySelectorAll('.lazy-img'));
  const CONCURRENT_LIMIT=5; // M√°ximo 5 im√°genes al mismo tiempo
  
  async function loadImage(img){
    const code=img.dataset.code;
    if(!code||img.dataset.loaded)return;
    
    try{
      const response=await fetch(`https://temponovo-api.onrender.com/api/product-image/${code}`);
      if(response.ok){
        const data=await response.json();
        if(data.image_base64){
          img.src=`data:image/png;base64,${data.image_base64}`;
          img.dataset.loaded='true';
        }
      }
    }catch(err){
      console.error('Error loading image:',code,err);
    }
  }
  
  // Procesar en lotes de CONCURRENT_LIMIT
  for(let i=0;i<lazyImages.length;i+=CONCURRENT_LIMIT){
    const batch=lazyImages.slice(i,i+CONCURRENT_LIMIT);
    await Promise.all(batch.map(img=>loadImage(img)));
  }
}

async function generateSelectedPDF(){
  if(selectedProducts.size===0){
    showToast('Selecciona al menos un producto');
    return;
  }
  const selectedList=filteredProducts.filter(p=>selectedProducts.has(p.Default_code));
  showToast('Generando PDF...');
  try{
    await generatePDF(currentCatalog.name+' (Selecci√≥n)',selectedList);
    showToast('‚úì PDF descargado');
  }catch(err){
    console.error('PDF error:',err);
    showToast('Error al generar PDF');
  }
}

function formatPrice(p){
  if(!p)return'$0';
  return '$'+Math.round(p).toLocaleString('es-CL');
}
function formatPriceNum(p){
  if(!p)return'0';
  return Math.round(p).toLocaleString('es-CL');
}

function cleanProductName(name,parent,code){
  if(!name)return'Sin nombre';
  let clean=name;
  
  // 1. Quitar el c√≥digo si est√° en el nombre
  if(code){
    const codePattern=new RegExp(code.replace(/[-]/g,'\\-'),'gi');
    clean=clean.replace(codePattern,'').trim();
  }
  
  // 2. Quitar prefijos comunes basados en Parent_category
  if(parent){
    const prefixes=[
      parent,
      `${parent} -`,
      `${parent} Casio`,
      `${parent} Casio -`,
      'Relojes',
      'Relojes Casio',
      'Relojes Q&Q',
      'Relojes Q&Q -',
      'Calculadora',
      'Calculadora Casio',
      'Calculadoras',
      'Calculadoras Casio'
    ];
    for(const prefix of prefixes){
      const regex=new RegExp(`^${prefix}\\s*-?\\s*`,'i');
      clean=clean.replace(regex,'').trim();
    }
  }
  
  // 3. Limpiar espacios y guiones extras
  clean=clean.replace(/^\s*-\s*/,'').replace(/\s*-\s*$/,'').trim();
  clean=clean.replace(/\s+/g,' ');
  
  return clean||name;
}

function cleanProductCode(code, productName){
  if(!code) return '';
  
  // Si tenemos el nombre del producto, extraer el c√≥digo de ah√≠
  if(productName){
    // Buscar patrones de c√≥digo en el nombre
    // Ejemplo: "RELOJ CASIO MTP-VD01D-1EV" ‚Üí extraer "MTP-VD01D-1EV"
    // Ejemplo: "CALCULADORA CASIO LC-401" ‚Üí extraer "LC-401"
    // Ejemplo: "PILA MAXELL LITIO CR1216" ‚Üí extraer "CR1216"
    
    const patterns = [
      // Patr√≥n 1: Letras-N√∫meros-Letras (MTP-VD01D-1EV, LC-401, KK-7800-12)
      /([A-Z]{2,4}-[A-Z0-9-]+)/g,
      // Patr√≥n 2: ZP seguido de n√∫meros (ZP49844ZL)
      /(ZP[0-9A-Z]+)/g,
      // Patr√≥n 3: CR seguido de n√∫meros (CR1216 - pilas)
      /(CR[0-9]+)/g,
      // Patr√≥n 4: C√≥digo alfanum√©rico simple (FX-82, DM-1400)
      /([A-Z]{2,3}-[0-9A-Z]+)/g
    ];
    
    for(const pattern of patterns){
      const matches = productName.match(pattern);
      if(matches && matches.length > 0){
        // Tomar el √∫ltimo match (suele ser el c√≥digo correcto)
        return matches[matches.length - 1];
      }
    }
  }
  
  // Si no encontramos nada en el nombre, limpiar el c√≥digo original
  // Quitar prefijos tipo CS-, CA-, RE-, etc
  let clean = code.replace(/^[A-Z]{2,3}-/, '');
  
  // Quitar repeticiones tipo CA-CA-
  clean = clean.replace(/^([A-Z]{2,3})-\1-/, '$1-');
  
  return clean;
}

function getSubfamilyName(category){
  if(!category) return '';
  // Si tiene "/" tomar solo la √∫ltima parte
  // "Relojes Casio / Murales y Crono" ‚Üí "Murales y Crono"
  const parts = category.split('/');
  return parts[parts.length - 1].trim();
}

async function generatePDF(catName, products) {
  const {jsPDF} = window.jspdf;
  showToast('Preparando PDF...');

  const pdf   = new jsPDF({orientation:'portrait', unit:'mm', format:'a4'});
  const pageW = 210;
  const pageH = 297;
  const mg    = 6;

  // Header embebido como imagen fija
  const HEADER_B64 = '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oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQVm6oVm7y8y8ZnkOqFZu8vMvGZ5AFmQQjsn+Tvbdn2b0mUU2bZJdZKZkjEpqyVqxO32K3VUROzXVCbgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD//2Q==';
  const headerH = 18; // alto del header en mm

  // ‚îÄ‚îÄ Im√°genes productos ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  showToast(`Cargando ${products.length} im√°genes...`);
  const prodImgs = {};
  for (let i = 0; i < products.length; i += 8) {
    await Promise.all(products.slice(i, i+8).map(async p => {
      if (!p.Default_code) return;
      try {
        const r = await fetch(`https://temponovo-api.onrender.com/api/product-image/${p.Default_code}`);
        if (r.ok) { const d = await r.json(); if (d.image_base64) prodImgs[p.Default_code] = d.image_base64; }
      } catch(e) {}
    }));
    showToast(`Cargadas ${Math.min(i+8, products.length)}/${products.length} im√°genes`);
  }
  showToast('Generando PDF...');

  // ‚îÄ‚îÄ Layout ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const cols = 4, rows = 3, perPage = 12;
  const footerH = 5;
  const gapX = 0, gapY = 0;
  const cellW = (pageW - mg*2) / cols;
  const cellH = (pageH - mg*2 - headerH - footerH) / rows;
  const imgAreaH = cellH * 0.64;

  // ‚îÄ‚îÄ HEADER como imagen ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function drawHeader() {
    try {
      pdf.addImage('data:image/png;base64,' + HEADER_B64, 'PNG',
        0, 0, pageW, headerH);
    } catch(e) {
      // fallback texto
      pdf.setFontSize(8); pdf.setFont('helvetica','normal');
      pdf.setTextColor(40,163,150);
      pdf.text('TEMPONOVO  ¬∑  9 6292 9654  ¬∑  ventas@temponovo.cl', pageW/2, 8, {align:'center'});
    }
    pdf.setDrawColor(200,200,200); pdf.setLineWidth(0.2);
    pdf.line(mg, headerH, pageW-mg, headerH);
  }

  // ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function drawFooter() {
    const fy = pageH - mg - footerH;
    pdf.setDrawColor(200,200,200); pdf.setLineWidth(0.15);
    pdf.line(mg, fy, pageW-mg, fy);
    pdf.setFontSize(6); pdf.setFont('helvetica','normal'); pdf.setTextColor(160,160,160);
    const hoy = new Date().toLocaleDateString('es-CL',{day:'2-digit',month:'2-digit',year:'numeric'});
    pdf.text(`Precios sin IVA  ¬∑  ${hoy}`, pageW/2, fy+3.5, {align:'center'});
  }

  // ‚îÄ‚îÄ PRODUCTOS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  for (const [idx, p] of products.entries()) {
    if (idx % perPage === 0) {
      if (idx > 0) { drawFooter(); pdf.addPage(); }
      drawHeader();
    }

    const pos = idx % perPage;
    const col = pos % cols;
    const row = Math.floor(pos / cols);
    const x   = mg + col * cellW;
    const y   = headerH + 0.5 + row * cellH;

    // Reset estado limpio
    pdf.setDrawColor(255,255,255); pdf.setFillColor(255,255,255); pdf.setLineWidth(0.1);

    // ‚îÄ‚îÄ Imagen ‚îÄ‚îÄ
    const b64 = prodImgs[p.Default_code];
    if (b64) {
      let mime = 'JPEG';
      try { if (atob(b64.substring(0,8)).charCodeAt(0)===0x89) mime='PNG'; } catch(e){}
      const dims = await new Promise(res => {
        const img = new Image();
        img.onload  = () => res({w:img.naturalWidth, h:img.naturalHeight});
        img.onerror = () => res({w:1, h:1});
        img.src = `data:image/${mime==='PNG'?'png':'jpeg'};base64,${b64}`;
      });
      const pad=2, maxW=cellW-pad*2, maxH=imgAreaH-pad*2;
      const ir=dims.w/dims.h, cr=maxW/maxH;
      let fw,fh;
      if(ir>cr){fw=maxW;fh=maxW/ir;}else{fh=maxH;fw=maxH*ir;}
      try {
        pdf.addImage(`data:image/${mime==='PNG'?'png':'jpeg'};base64,${b64}`,
          mime, x+pad+(maxW-fw)/2, y+pad+(maxH-fh)/2, fw, fh, p.Default_code, 'FAST');
      } catch(e) {
        const alt=mime==='PNG'?'JPEG':'PNG';
        try { pdf.addImage(`data:image/${alt.toLowerCase()};base64,${b64}`,
          alt, x+pad+(maxW-fw)/2, y+pad+(maxH-fh)/2, fw, fh, p.Default_code+'b', 'FAST'); } catch(e2){}
      }
    }

    // ‚îÄ‚îÄ C√≥digo ‚îÄ‚îÄ
    const infoY = y + imgAreaH;
    pdf.setFontSize(7); pdf.setFont('helvetica','bold');
    pdf.setTextColor(0,0,0);
    pdf.text(cleanProductCode(p.Default_code, p.Name)||'', x+cellW/2, infoY+3.2, {align:'center'});

    // ‚îÄ‚îÄ Precio ‚îÄ‚îÄ
    pdf.setFontSize(6.5); pdf.setFont('helvetica','normal');
    pdf.setTextColor(0,0,0);
    pdf.text(`$${formatPriceNum(p.Price||0)} + IVA`, x+cellW/2, infoY+6.5, {align:'center'});

    // ‚îÄ‚îÄ Caracter√≠sticas ‚îÄ‚îÄ
    const caract = caracteristicas[p.Default_code];
    if (caract) {
      const specs = [];
      if (caract.color)            specs.push(caract.color);
      if (caract.tamano_esfera)    specs.push(`Esfera ${caract.tamano_esfera} mm`);
      if (caract.resistencia_agua) specs.push(caract.resistencia_agua);
      if (caract.genero)           specs.push(caract.genero);
      if (specs.length) {
        pdf.setFontSize(5.5); pdf.setFont('helvetica','normal');
        pdf.setTextColor(120,120,120);
        const lines = pdf.splitTextToSize(specs.join(' ¬∑ '), cellW-2);
        lines.slice(0,2).forEach((l,li) =>
          pdf.text(l, x+cellW/2, infoY+9.5+li*3.2, {align:'center'}));
      }
    }
  }

  drawFooter();
  pdf.save(`${catName.replace(/[^a-z0-9√°√©√≠√≥√∫√±]/gi,'_')}.pdf`);
  showToast(`‚úì PDF: ${Object.keys(prodImgs).length}/${products.length} con foto`);
}
async function shareCatalogPDF(){
  if(!currentCatalog)return;
  showToast('Generando PDF...');
  try{
    await generatePDF(currentCatalog.name,filteredProducts);
    showToast('‚úì PDF descargado');
  }catch(err){
    console.error('PDF error:',err);
    showToast('Error al generar PDF');
  }
}

async function downloadSelectedCatalogs(){
  if(selectedCatalogs.size===0){
    showToast('Selecciona al menos una familia');
    return;
  }
  showToast(`Generando ${selectedCatalogs.size} PDFs...`);
  let completed=0;
  for(const familyName of selectedCatalogs){
    const cats=catalogsByCategory[familyName];
    if(!cats)continue;
    const familyProducts=cats.flatMap(c=>c.products);
    try{
      await generatePDF(familyName,familyProducts);
      completed++;
      await new Promise(res=>setTimeout(res,500));
    }catch(err){
      console.error(`Error generando ${familyName}:`,err);
    }
  }
  showToast(`‚úì ${completed} PDFs descargados`);
  selectedCatalogs.clear();
  renderCatalogList();
  updateSelectionUI();
}

async function downloadAllCatalogs(){
  if(Object.keys(catalogs).length===0){
    showToast('No hay cat√°logos disponibles');
    return;
  }
  showToast(`Generando ${Object.keys(catalogs).length} PDFs...`);
  let completed=0;
  for(const[catName,catalog]of Object.entries(catalogs)){
    try{
      await generatePDF(catName,catalog.products);
      completed++;
      await new Promise(res=>setTimeout(res,500));
    }catch(err){
      console.error(`Error generando ${catName}:`,err);
    }
  }
  showToast(`‚úì ${completed} PDFs descargados`);
}

function showAdminPanel(){
  const url=prompt('URL base de fotos en Google Drive:',localStorage.getItem('photo_base_url')||'');
  if(url!==null){
    localStorage.setItem('photo_base_url',url.trim());
    showToast('‚úì URL de fotos guardada');
    if(currentCatalog){
      openCatalog(encodeURIComponent(currentCatalog.name));
    }
  }
}

function showScreen(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  window.scrollTo(0,0);
}

function goHome(){
  showScreen('home');
  const sidebar=document.getElementById('filters-sidebar');
  const overlay=document.getElementById('filters-overlay');
  sidebar.classList.remove('open');
  overlay.classList.remove('show');
}

function showToast(msg){
  const t=document.getElementById('toast');
  t.textContent=msg;
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),3000);
}

// Variable para el intervalo de sincronizaci√≥n
let syncInterval = null;

// Mostrar pantalla de carga inicial
function showLoadingScreen(message, progress = null) {
  let loadingDiv = document.getElementById('initial-loading');
  
  if (!loadingDiv) {
    loadingDiv = document.createElement('div');
    loadingDiv.id = 'initial-loading';
    loadingDiv.style.cssText = `
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #2c3e50;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 99999;
      font-family: Roboto, sans-serif;
    `;
    loadingDiv.innerHTML = `
      <div style="text-align: center; max-width: 400px; padding: 20px;">
        <div style="font-size: 48px; margin-bottom: 20px;">üì¶</div>
        <h2 style="margin-bottom: 10px; font-size: 24px;">Temponovo</h2>
        <p id="loading-message" style="margin-bottom: 20px; font-size: 16px; opacity: 0.9;">Preparando cat√°logo...</p>
        <div id="loading-progress" style="display: none;">
          <div style="background: rgba(255,255,255,0.2); border-radius: 10px; height: 8px; overflow: hidden; margin-bottom: 10px;">
            <div id="progress-bar" style="background: #4caf50; height: 100%; width: 0%; transition: width 0.3s;"></div>
          </div>
          <p id="progress-text" style="font-size: 14px; opacity: 0.8;">0 / 0</p>
        </div>
      </div>
    `;
    document.body.appendChild(loadingDiv);
  }
  
  document.getElementById('loading-message').textContent = message;
  
  if (progress) {
    document.getElementById('loading-progress').style.display = 'block';
    const percent = (progress.current / progress.total) * 100;
    document.getElementById('progress-bar').style.width = percent + '%';
    document.getElementById('progress-text').textContent = `${progress.current} / ${progress.total}`;
  }
}

function hideLoadingScreen() {
  const loadingDiv = document.getElementById('initial-loading');
  if (loadingDiv) {
    loadingDiv.style.opacity = '0';
    loadingDiv.style.transition = 'opacity 0.3s';
    setTimeout(() => loadingDiv.remove(), 300);
  }
}

// Descargar TODAS las im√°genes con progreso
async function downloadAllImages(products, swRegistration) {
  showLoadingScreen('Descargando im√°genes...', {current: 0, total: products.length});
  
  const imageUrls = products
    .filter(p => p.Default_code)
    .map(p => ({
      code: p.Default_code,
      url: `https://temponovo-api.onrender.com/api/product-image/${p.Default_code}`
    }));
  
  let downloaded = 0;
  const BATCH_SIZE = 10;
  
  for (let i = 0; i < imageUrls.length; i += BATCH_SIZE) {
    const batch = imageUrls.slice(i, i + BATCH_SIZE);
    
    await Promise.all(
      batch.map(async ({url}) => {
        try {
          const response = await fetch(url);
          if (response.ok) {
            // El Service Worker cachear√° autom√°ticamente
            downloaded++;
            showLoadingScreen('Descargando im√°genes...', {
              current: downloaded,
              total: imageUrls.length
            });
          }
        } catch (err) {
          console.log('Error descargando imagen:', url);
        }
      })
    );
  }
  
  console.log(`‚úÖ ${downloaded}/${imageUrls.length} im√°genes descargadas`);
  return downloaded;
}

// Sincronizaci√≥n autom√°tica
async function autoSync() {
  if (!navigator.onLine) {
    console.log('Sin conexi√≥n - omitiendo sincronizaci√≥n');
    return;
  }
  
  console.log('üîÑ Sincronizaci√≥n autom√°tica iniciada');
  setSyncStatus('Syncing');
  
  const success = await fetchProducts();
  
  if (success) {
    buildCatalogs();
    
    // Descargar im√°genes nuevas en background
    const imageUrls = allProducts
      .filter(p => p.Default_code)
      .map(p => `https://temponovo-api.onrender.com/api/product-image/${p.Default_code}`);
    
    // Descargar de a poco sin bloquear UI
    const BATCH_SIZE = 5;
    for (let i = 0; i < imageUrls.length; i += BATCH_SIZE) {
      const batch = imageUrls.slice(i, i + BATCH_SIZE);
      await Promise.all(batch.map(url => fetch(url).catch(() => {})));
      await new Promise(r => setTimeout(r, 100)); // Pausa peque√±a
    }
    
    showToast('‚úì Cat√°logo actualizado');
    console.log('‚úÖ Sincronizaci√≥n completada');
  }
  
  setSyncStatus(navigator.onLine ? 'Online' : 'Offline');
}

// Inicializaci√≥n mejorada
// ‚îÄ‚îÄ Capturar logo al arrancar ‚Äî reutilizar en PDF ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
window.appLogoB64 = null;
window.appLogoAR  = 3.8;
(function() {
  const tryCapture = () => {
    const imgEl = document.querySelector('img.logo');
    if (!imgEl) return;
    const doCapture = () => {
      try {
        const cv = document.createElement('canvas');
        cv.width  = imgEl.naturalWidth  || 400;
        cv.height = imgEl.naturalHeight || 105;
        cv.getContext('2d').drawImage(imgEl, 0, 0);
        window.appLogoB64 = cv.toDataURL('image/png');
        window.appLogoAR  = cv.width / cv.height;
        console.log('‚úÖ Logo capturado (canvas), AR:', window.appLogoAR);
      } catch(e) {
        fetch(imgEl.src).then(r=>r.arrayBuffer()).then(ab=>{
          const u8=new Uint8Array(ab); let bin='';
          for(let i=0;i<u8.length;i+=8192) bin+=String.fromCharCode(...u8.subarray(i,i+8192));
          window.appLogoB64='data:image/png;base64,'+btoa(bin);
          const tmp=new Image();
          tmp.onload=()=>{window.appLogoAR=tmp.naturalWidth/tmp.naturalHeight;};
          tmp.src=window.appLogoB64;
          console.log('‚úÖ Logo capturado (fetch)');
        }).catch(()=>console.log('‚ö† Logo no disponible'));
      }
    };
    if(imgEl.complete && imgEl.naturalWidth>0) doCapture();
    else imgEl.addEventListener('load', doCapture);
  };
  if(document.readyState==='loading') document.addEventListener('DOMContentLoaded',tryCapture);
  else tryCapture();
})();

async function init() {
  // Registrar Service Worker
  let swRegistration;
  if ('serviceWorker' in navigator) {
    try {
      swRegistration = await navigator.serviceWorker.register('/sw.js');
      console.log('‚úÖ Service Worker registrado');
      
      // Escuchar mensajes del SW
      navigator.serviceWorker.addEventListener('message', event => {
        if (event.data.type === 'PRECACHE_PROGRESS') {
          const {processed, total} = event.data;
          showLoadingScreen('Descargando im√°genes...', {current: processed, total});
        }
      });
    } catch (err) {
      console.error('‚ùå Service Worker error:', err);
    }
  }
  
  // Cargar caracter√≠sticas primero
  await fetchCaracteristicas();
  
  // Intentar cargar productos guardados
  allProducts = await loadProducts();
  const lastSync = await getLastSync();
  
  const isFirstLoad = !allProducts || allProducts.length === 0;
  
  console.log('Estado:', {
    isFirstLoad,
    productsCount: allProducts ? allProducts.length : 0,
    lastSync: lastSync ? new Date(lastSync).toLocaleString() : 'nunca',
    online: navigator.onLine
  });
  
  if (isFirstLoad) {
    // PRIMERA CARGA - Descargar TODO
    console.log('üÜï Primera carga detectada');
    showLoadingScreen('Conectando con Odoo...');
    
    if (!navigator.onLine) {
      hideLoadingScreen();
      showToast('‚ùå Sin conexi√≥n. Conecta a internet para la primera carga.');
      return;
    }
    
    // 1. Descargar productos
    showLoadingScreen('Cargando productos desde Odoo...');
    const success = await fetchProducts();
    
    if (!success || !allProducts || allProducts.length === 0) {
      hideLoadingScreen();
      showToast('‚ùå Error al cargar productos');
      return;
    }
    
    console.log(`‚úÖ ${allProducts.length} productos descargados`);
    buildCatalogs();
    
    // 2. Descargar TODAS las im√°genes
    await downloadAllImages(allProducts, swRegistration);
    
    showLoadingScreen('¬°Listo! Abriendo cat√°logo...');
    await new Promise(r => setTimeout(r, 500));
    
    hideLoadingScreen();
    setSyncStatus(navigator.onLine ? 'Online' : 'Offline');
    updateLastSyncDisplay(Date.now());
    showToast('‚úì Cat√°logo listo para usar offline');
    
  } else {
    // CARGA NORMAL - Ya tiene datos guardados
    console.log(`‚úÖ Cargando ${allProducts.length} productos guardados`);
    
    buildCatalogs();
    setSyncStatus(navigator.onLine ? 'Online' : 'Offline');
    updateLastSyncDisplay(lastSync);
    
    // Verificar si necesita actualizaci√≥n
    const needsUpdate = Date.now() - lastSync > UPDATE_INTERVAL;
    
    console.log('Necesita actualizaci√≥n:', needsUpdate, 'Online:', navigator.onLine);
    
    if (navigator.onLine && needsUpdate) {
      // Sincronizar en background (sin bloquear la UI)
      console.log('üîÑ Programando sincronizaci√≥n en background...');
      setTimeout(() => autoSync(), 2000);
    }
  }
  
  // Configurar sincronizaci√≥n autom√°tica cada 3 horas
  if (syncInterval) clearInterval(syncInterval);
  syncInterval = setInterval(() => {
    if (navigator.onLine) {
      autoSync();
    }
  }, UPDATE_INTERVAL);
  
  // Evento cuando vuelve conexi√≥n
  window.addEventListener('online', async () => {
    showToast('‚úì Conexi√≥n restaurada');
    await autoSync();
  });
  
  // Evento cuando pierde conexi√≥n
  window.addEventListener('offline', () => {
    showToast('üì¥ Sin conexi√≥n - Usando datos guardados');
    setSyncStatus('Offline');
  });
}

init();
</script>
</body>
</html>
